<?php
/**
 * My Account Dashboard
 *
 * Shows the first intro screen on the account dashboard.
 *
 * This template can be overridden by copying it to yourtheme/woocommerce/myaccount/dashboard.php.
 *
 * HOWEVER, on occasion WooCommerce will need to update template files and you
 * (the theme developer) will need to copy the new files to your theme to
 * maintain compatibility. We try to do this as little as possible, but it does
 * happen. When this occurs the version of the template file will be bumped and
 * the readme will list any important changes.
 *
 * @see     https://docs.woocommerce.com/document/template-structure/
 * @package WooCommerce\Templates
 * @version 4.4.0
 */

if (!defined('ABSPATH')) {
    exit; // Exit if accessed directly.
}

$allowed_html = array(
    'a' => array(
        'href' => array(),
    ),
);

$total_orders = nxt_get_user_total_orders();


$completed_orders = nxt_get_user_completed_orders();


$pending_orders = nxt_get_user_pending_orders();


?>

<div class="nxt-dashboard-overview">
    <!-- Stats Cards -->
    <div class="nxt-dashboard-stats">
        <div class="nxt-stat-card">
            <div class="nxt-stat-icon">
                <svg width="44" height="44" viewBox="0 0 44 44" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M19.2133 20.4417C19.6691 20.6323 20.1417 20.7796 20.625 20.8817V38.335C20.3284 38.259 20.0399 38.1547 19.7633 38.0234L8.76333 33.1284C7.79209 32.696 6.96695 31.9915 6.38779 31.0999C5.80863 30.2084 5.50026 29.1681 5.5 28.105V15.895C5.50246 15.4054 5.57028 14.9183 5.70167 14.4467L19.2133 20.4417ZM27.17 16.3534L12.2283 9.33169L8.76333 10.8717C8.13823 11.146 7.5718 11.5382 7.095 12.0267L20.3133 17.9117C20.8445 18.1472 21.419 18.2688 22 18.2688C22.581 18.2688 23.1555 18.1472 23.6867 17.9117L27.17 16.3534ZM36.905 12.0267C36.4282 11.5382 35.8618 11.146 35.2367 10.8717L24.2367 5.97669C23.5336 5.65991 22.7712 5.49609 22 5.49609C21.2288 5.49609 20.4664 5.65991 19.7633 5.97669L15.565 7.84669L30.5067 14.8684L36.905 12.0267ZM38.2983 14.4467L31.8633 17.3067V21.7984C31.8633 22.163 31.7185 22.5128 31.4606 22.7706C31.2027 23.0285 30.853 23.1734 30.4883 23.1734C30.1237 23.1734 29.7739 23.0285 29.5161 22.7706C29.2582 22.5128 29.1133 22.163 29.1133 21.7984V18.5167L24.7867 20.4417C24.3287 20.6261 23.8566 20.7733 23.375 20.8817V38.335C23.6716 38.259 23.9601 38.1547 24.2367 38.0234L35.2367 33.1284C36.2079 32.696 37.033 31.9915 37.6122 31.0999C38.1914 30.2084 38.4997 29.1681 38.5 28.105V15.895C38.4975 15.4054 38.4297 14.9183 38.2983 14.4467Z"
                        fill="#1F487E" />
                </svg>
            </div>
            <div class="nxt-stat-content">
                <h3><?php esc_html_e('Total Orders', 'hello-elementor-child'); ?></h3>
                <span class="nxt-stat-number"><?php echo esc_html($total_orders); ?></span>
            </div>
        </div>

        <div class="nxt-stat-card">
            <div class="nxt-stat-icon">
                <svg width="44" height="44" viewBox="0 0 44 44" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M22.0001 7.70275C26.1863 7.70275 29.5799 11.0963 29.5799 15.2824C29.5799 19.4685 26.1863 22.8621 22.0001 22.8621C17.8139 22.8621 14.4205 19.4686 14.4205 15.2824C14.4205 11.0964 17.8139 7.70275 22.0001 7.70275ZM22.6876 29.2004V43.4246L36.7186 37.9691V29.0739L25.7475 33.3398C25.4284 33.4632 25.0734 33.3314 24.9075 33.0441L22.6876 29.2004ZM21.3126 43.4246V29.2004L19.0934 33.0443C19.0088 33.1903 18.8734 33.3 18.7131 33.3525C18.5527 33.4049 18.3787 33.3964 18.2242 33.3285L7.28179 29.0739V37.969L21.3126 43.4246ZM37.1058 21.4995L22.9936 26.9868L25.8005 31.8486L39.9129 26.3613L37.1058 21.4995ZM21.0067 26.9868L6.89438 21.4995L4.0874 26.3613L18.1998 31.8486L21.0067 26.9868ZM22.0001 24.2371C18.2358 24.2371 15.014 21.9144 13.6897 18.6239L8.48508 20.6476L22.0001 25.9027L35.5152 20.6476L30.3105 18.6239C28.9863 21.9143 25.7645 24.2371 22.0001 24.2371ZM35.8387 14.7759C36.2186 14.7759 36.5262 15.0838 36.5262 15.4634C36.5262 15.8431 36.2186 16.1509 35.8387 16.1509H32.6189C32.4366 16.1509 32.2617 16.0785 32.1328 15.9496C32.0038 15.8206 31.9314 15.6458 31.9314 15.4634C31.9314 15.2811 32.0038 15.1062 32.1328 14.9773C32.2617 14.8484 32.4366 14.7759 32.6189 14.7759H35.8387ZM21.3126 1.26294C21.3126 1.0806 21.3851 0.905735 21.514 0.776804C21.6429 0.647872 21.8178 0.575439 22.0001 0.575439C22.1825 0.575439 22.3573 0.647872 22.4863 0.776804C22.6152 0.905735 22.6876 1.0806 22.6876 1.26294V4.48293C22.6876 4.66527 22.6152 4.84014 22.4863 4.96907C22.3573 5.098 22.1825 5.17043 22.0001 5.17043C21.8178 5.17043 21.6429 5.098 21.514 4.96907C21.3851 4.84014 21.3126 4.66527 21.3126 4.48293V1.26294ZM14.3726 3.3917C14.2846 3.23443 14.2622 3.04883 14.3102 2.87514C14.3582 2.70146 14.4727 2.5537 14.629 2.46393C14.7852 2.37415 14.9705 2.3496 15.1448 2.39559C15.319 2.44158 15.4681 2.55442 15.5596 2.70961L17.1696 5.4982C17.2576 5.65546 17.28 5.84107 17.232 6.01475C17.184 6.18844 17.0694 6.33619 16.9132 6.42597C16.757 6.51574 16.5716 6.5403 16.3974 6.4943C16.2232 6.44831 16.0741 6.33548 15.9825 6.18028L14.3726 3.3917ZM9.42464 8.70951C9.26867 8.61762 9.15536 8.4678 9.10941 8.29271C9.06345 8.11762 9.08857 7.93146 9.1793 7.77482C9.27003 7.61818 9.419 7.50376 9.59374 7.4565C9.76849 7.40924 9.95482 7.43298 10.1121 7.52254L12.9006 9.13249C13.0547 9.22534 13.1661 9.37497 13.2108 9.54915C13.2556 9.72334 13.2302 9.90814 13.1401 10.0638C13.0499 10.2194 12.9023 10.3334 12.7289 10.3812C12.5555 10.429 12.3703 10.4069 12.2131 10.3195L9.42464 8.70951ZM7.79964 15.789C7.61731 15.789 7.44244 15.7166 7.31351 15.5877C7.18458 15.4587 7.11214 15.2839 7.11214 15.1015C7.11214 14.9192 7.18458 14.7443 7.31351 14.6154C7.44244 14.4865 7.61731 14.414 7.79964 14.414H11.0196C11.3993 14.414 11.7071 14.7219 11.7071 15.1015C11.7071 15.4812 11.3993 15.789 11.0196 15.789H7.79964ZM28.3922 2.89051C28.4827 2.73315 28.632 2.61817 28.8072 2.57083C28.9825 2.52348 29.1694 2.54765 29.3268 2.63803C29.4842 2.7285 29.5992 2.87778 29.6466 3.05303C29.6939 3.22829 29.6697 3.41517 29.5793 3.5726L27.9693 6.36118C27.8789 6.5186 27.7296 6.63363 27.5544 6.68098C27.3791 6.72833 27.1922 6.70412 27.0348 6.61367C26.8774 6.52322 26.7623 6.37394 26.715 6.19867C26.6676 6.02341 26.6918 5.83651 26.7823 5.6791L28.3922 2.89051ZM33.7073 7.83587C33.8646 7.74631 34.051 7.72257 34.2257 7.76983C34.4004 7.81709 34.5494 7.93151 34.6401 8.08815C34.7309 8.24479 34.756 8.43095 34.71 8.60604C34.6641 8.78113 34.5508 8.93095 34.3948 9.02284L31.6062 10.6328C31.2785 10.8226 30.8588 10.7107 30.669 10.3831C30.4792 10.0554 30.5911 9.63566 30.9187 9.44582L33.7073 7.83587ZM24.8701 11.8259L20.3801 16.3159L18.8479 14.3877C18.4709 13.9135 17.781 13.8347 17.3069 14.2116C16.8327 14.5886 16.7539 15.2784 17.1309 15.7526L19.3857 18.5902C19.7756 19.1487 20.5786 19.2251 21.0644 18.7391L26.4238 13.3798C26.8528 12.9507 26.8528 12.255 26.4238 11.8259C25.9948 11.3969 25.2992 11.3969 24.8701 11.8259Z"
                        fill="#1F487E" />
                </svg>

            </div>
            <div class="nxt-stat-content">
                <h3><?php esc_html_e('Complete Orders', 'hello-elementor-child'); ?></h3>
                <span class="nxt-stat-number"><?php echo esc_html($completed_orders); ?></span>
            </div>
        </div>

        <div class="nxt-stat-card">
            <div class="nxt-stat-icon">
                <svg width="44" height="44" viewBox="0 0 44 44" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M17.7404 2C15.5974 2 13.8634 3.83623 13.4486 5.8467C13.1013 7.53036 13.5569 9.40834 14.7664 11.2775C16.2496 13.5699 18.7747 15.7651 22.2768 17.8082C31.6083 12.6111 31.7475 7.87549 31.3612 6.05532C30.8459 3.62678 28.7325 2.18185 27.0057 2.05537C25.4 1.93768 24.1548 2.84509 23.5001 4.61073C23.1149 5.65013 21.6154 5.69104 21.174 4.67455C20.4192 2.93719 19.2093 2 17.7404 2ZM3 21.895L16.853 29.6043L20.402 25.7046L5.8651 17.7723L3 21.895ZM24.3921 25.6853L27.9395 29.5834L41.8125 21.3582L38.9743 17.4224L24.3921 25.6853Z"
                        fill="#1F487E" />
                    <path
                        d="M6.73242 33.2786L21.1517 41.1468V28.6105L18.0388 32.0312C17.8487 32.2403 17.5934 32.379 17.3145 32.4247C17.0355 32.4705 16.7494 32.4205 16.5024 32.2831L6.73242 26.846V33.2786ZM23.6604 28.6105V41.1062L38.0797 32.9242V26.4911L28.3395 32.2661C28.0913 32.4133 27.8 32.4703 27.5146 32.4275C27.2293 32.3847 26.9674 32.2448 26.7733 32.0313L23.6604 28.6105ZM8.06108 16.109L22.3946 23.9304L36.7524 15.7947L31.8613 13.12C30.0038 15.7112 26.9833 18.1391 22.8629 20.3501C22.4858 20.5524 22.0169 20.5486 21.6429 20.3386C17.7806 18.1711 14.9078 15.7946 13.0837 13.2609L8.06108 16.109Z"
                        fill="#1F487E" />
                </svg>

            </div>
            <div class="nxt-stat-content">
                <h3><?php esc_html_e('Favorite Products', 'hello-elementor-child'); ?></h3>
                <span class="nxt-stat-number"><?php echo esc_html(nxt_get_user_wishlist_count()); ?></span>
            </div>
        </div>

        <div class="nxt-stat-card">
            <div class="nxt-stat-icon">
                <svg width="44" height="44" viewBox="0 0 44 44" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g clip-path="url(#clip0_1_4070)">
                        <path
                            d="M3.63359 36.4704C5.63848 36.4704 7.26376 34.8451 7.26376 32.8403C7.26376 30.8354 5.63848 29.2101 3.63359 29.2101C1.6287 29.2101 0.00341797 30.8354 0.00341797 32.8403C0.00341797 34.8451 1.6287 36.4704 3.63359 36.4704Z"
                            fill="#1F487E" />
                        <path
                            d="M35.7333 35.7333C32.065 39.4017 27.1878 41.4219 22 41.4219C17.4931 41.4219 13.1858 39.8667 9.75071 37.0715C9.24596 36.6608 8.48888 36.7571 8.02955 37.2181C7.54389 37.7055 7.46396 38.5253 7.99425 38.9637C11.9062 42.1979 16.8371 44 22 44C27.8764 44 33.4011 41.7117 37.5564 37.5564C41.4064 33.7062 43.6538 28.6805 43.9632 23.2886C44.0039 22.5778 43.4229 22 42.7109 22C41.999 22 41.4263 22.5779 41.3801 23.2884C41.0742 27.9913 39.0964 32.3704 35.7333 35.7333Z"
                            fill="#1F487E" />
                        <path
                            d="M40.3494 14.2464C42.3543 14.2464 43.9796 12.6211 43.9796 10.6163C43.9796 8.61137 42.3543 6.98608 40.3494 6.98608C38.3445 6.98608 36.7192 8.61137 36.7192 10.6163C36.7192 12.6211 38.3445 14.2464 40.3494 14.2464Z"
                            fill="#1F487E" />
                        <path
                            d="M35.7218 6.48364C36.167 5.98534 36.2116 5.19352 35.6887 4.77765C31.8074 1.69116 26.9842 -0.000919133 22 3.74561e-07C16.1236 3.74561e-07 10.5989 2.28834 6.44359 6.44359C2.59342 10.2937 0.346166 15.3195 0.0368573 20.7114C-0.00391587 21.4222 0.577133 22 1.28906 22C2.00099 22 2.57368 21.4221 2.61989 20.7116C2.92582 16.0087 4.90366 11.6296 8.26667 8.26667C11.935 4.59843 16.8122 2.57813 22 2.57813C26.3489 2.57738 30.5589 4.03663 33.9644 6.70129C34.4921 7.11421 35.2754 6.98335 35.7218 6.48364Z"
                            fill="#1F487E" />
                        <path
                            d="M14.4429 14.4164C13.7762 14.8013 13.7762 15.7635 14.4429 16.1484L21.5002 20.2229C21.8096 20.4016 22.1908 20.4016 22.5002 20.2229L29.5575 16.1484C30.2241 15.7635 30.2241 14.8013 29.5575 14.4164L22.5002 10.3418C22.1908 10.1631 21.8096 10.1631 21.5002 10.3418L14.4429 14.4164ZM32.3465 19.2471C32.3465 18.4773 31.5132 17.9962 30.8465 18.3811L23.7892 22.4556C23.4798 22.6342 23.2892 22.9643 23.2892 23.3216V31.4706C23.2892 32.2404 24.1226 32.7216 24.7892 32.3367L31.8465 28.2621C32.1559 28.0835 32.3465 27.7534 32.3465 27.3961V19.2471ZM19.2111 32.3367C19.8778 32.7216 20.7111 32.2404 20.7111 31.4706V23.3216C20.7111 22.9643 20.5205 22.6342 20.2111 22.4556L13.1538 18.3811C12.4871 17.9962 11.6538 18.4773 11.6538 19.2471V27.3961C11.6538 27.7534 11.8444 28.0835 12.1538 28.2621L19.2111 32.3367Z"
                            fill="#1F487E" />
                    </g>
                    <defs>
                        <clipPath id="clip0_1_4070">
                            <rect width="44" height="44" fill="white" />
                        </clipPath>
                    </defs>
                </svg>

            </div>
            <div class="nxt-stat-content">
                <h3><?php esc_html_e('Order in progress', 'hello-elementor-child'); ?></h3>
                <span class="nxt-stat-number"><?php echo esc_html($pending_orders); ?></span>
            </div>
        </div>
    </div>

    <!-- Content Grid -->
    <div class="nxt-dashboard-content">
        <!-- Favorite Products Section -->
        <div class="nxt-dashboard-section">
            <div class="nxt-section-header">
                <h2><?php esc_html_e('Favorite products', 'hello-elementor-child'); ?></h2>
                <a href="<?php echo esc_url(wc_get_account_endpoint_url('favorites')); ?>" class="nxt-see-all">
                    <?php esc_html_e('See all', 'hello-elementor-child'); ?>
                </a>
            </div>
            <div class="nxt-favorites-preview">
                <?php echo do_shortcode('[nxt_wishlist_preview limit="4"]'); ?>
            </div>
        </div>

        <!-- My Orders Section -->
        <div class="nxt-dashboard-section">
            <div class="nxt-section-header">
                <h2><?php esc_html_e('My orders', 'hello-elementor-child'); ?></h2>
                <a href="<?php echo esc_url(wc_get_account_endpoint_url('orders')); ?>" class="nxt-see-all">
                    <?php esc_html_e('See all', 'hello-elementor-child'); ?>
                </a>
            </div>
            <div class="nxt-orders-preview">
                <?php nxt_display_recent_orders(3); ?>
            </div>
        </div>
    </div>

    <!-- Popular Products Section -->
    <?php nxt_display_popular_products_carousel(6); ?>
</div>